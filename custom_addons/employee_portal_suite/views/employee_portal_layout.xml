<?xml version="1.0" encoding="UTF-8"?>
<odoo>

<template id="employee_portal_app_shell">
<t t-call-assets="web.assets_frontend"/>

<style>

/* ==============================
   APP ROOT
============================== */

html, body {
    height:100%;
    margin:0;
    background:#f5f7fb;
    font-family: Inter, -apple-system, BlinkMacSystemFont, sans-serif;
}

.ep-app {
    display:flex;
    min-height:100vh;
}

/* ==============================
   SIDEBAR (DESKTOP)
============================== */

.ep-sidebar {
    width:260px;
    background:white;
    border-right:1px solid #e5e7eb;
    padding:30px 20px;
    display:flex;
    flex-direction:column;
}

.ep-logo {
    font-weight:700;
    font-size:20px;
    margin-bottom:40px;
    display:flex;
    align-items:center;
    gap:10px;
}

.ep-logo-box {
    width:36px;
    height:36px;
    background:#4f46e5;
    border-radius:10px;
    color:white;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:700;
}

.ep-nav a {
    display:block;
    padding:10px 14px;
    border-radius:10px;
    text-decoration:none;
    color:#374151;
    font-weight:500;
    margin-bottom:6px;
    transition:0.2s;
}

.ep-nav a:hover {
    background:#eef2ff;
    color:#4f46e5;
}

.ep-nav a.active {
    background:#eef2ff;
    color:#4f46e5;
    font-weight:600;
}

/* ==============================
   MAIN AREA
============================== */

.ep-main {
    flex:1;
    display:flex;
    flex-direction:column;
}

/* HEADER */

.ep-header {
    height:70px;
    background:white;
    border-bottom:1px solid #e5e7eb;
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 30px;
}

.ep-user {
    display:flex;
    align-items:center;
    gap:12px;
}

.ep-user img {
    width:36px;
    height:36px;
    border-radius:50%;
    object-fit:cover;
}

.ep-content {
    padding:40px;
    flex:1;
}

/* ==============================
   MOBILE
============================== */

.ep-mobile-header {
    display:none;
}

.ep-bottom-nav {
    display:none;
}

@media (max-width:992px) {

    .ep-sidebar {
        display:none;
    }

    .ep-header {
        display:none;
    }

    .ep-mobile-header {
        display:flex;
        align-items:center;
        justify-content:space-between;
        padding:18px 20px;
        background:white;
        border-bottom:1px solid #e5e7eb;
        position:sticky;
        top:0;
        z-index:1000;
    }

    .ep-content {
        padding:20px;
        padding-bottom:90px;
    }

    .ep-bottom-nav {
        display:flex;
        position:fixed;
        bottom:0;
        left:0;
        width:100%;
        background:white;
        border-top:1px solid #e5e7eb;
        justify-content:space-around;
        padding:10px 0;
    }

    .ep-bottom-nav a {
        text-decoration:none;
        font-size:12px;
        color:#6b7280;
        display:flex;
        flex-direction:column;
        align-items:center;
    }

    .ep-bottom-nav a.active {
        color:#4f46e5;
        font-weight:600;
    }
}

</style>

<div class="ep-app">

    <!-- DESKTOP SIDEBAR -->
    <aside class="ep-sidebar">

        <div class="ep-logo">
            <div class="ep-logo-box">E</div>
            Enterprise
        </div>

       <nav class="ep-nav">

            <!-- Dashboard -->
            <a href="/my"
            t-att-class="'active' if request.httprequest.path == '/my' else ''">
                Dashboard
            </a>

            <!-- Requests -->
            <a href="/my/employee/requests"
            t-att-class="'active' if request.httprequest.path.startswith('/my/employee/requests') else ''">
                Employee Requests
            </a>

            <a href="/my/employee/material"
            t-att-class="'active' if request.httprequest.path.startswith('/my/employee/material') else ''">
                Material Requests
            </a>

            <!-- =========================
                APPROVALS SECTION
            ========================== -->

            <t t-if="
                request.env.user.has_group('employee_portal_suite.group_employee_portal_manager')
                or request.env.user.has_group('employee_portal_suite.group_employee_portal_hr')
                or request.env.user.has_group('employee_portal_suite.group_employee_portal_finance')
                or request.env.user.has_group('employee_portal_suite.group_employee_portal_ceo')
            ">
                <a href="/my/employee/approvals"
                t-att-class="'active' if request.httprequest.path.startswith('/my/employee/approvals') else ''">
                    Employee Approvals
                </a>
            </t>

            <t t-if="
                request.env.user.has_group('employee_portal_suite.group_mr_purchase_rep')
                or request.env.user.has_group('employee_portal_suite.group_mr_store_manager')
                or request.env.user.has_group('employee_portal_suite.group_mr_project_manager')
                or request.env.user.has_group('employee_portal_suite.group_mr_projects_director')
                or request.env.user.has_group('employee_portal_suite.group_employee_portal_ceo')
            ">
                <a href="/my/employee/material/approvals"
                t-att-class="'active' if request.httprequest.path.startswith('/my/employee/material/approvals') else ''">
                    Material Approvals
                </a>
            </t>

            <!-- Petty Cash -->
            <t t-if="request.env.user.has_group('petty_cash_management.group_portal_petty_cash_user')">
                <a href="/my/petty-cash"
                t-att-class="'active' if request.httprequest.path.startswith('/my/petty-cash') else ''">
                    Petty Cash
                </a>
            </t>

        </nav>


    </aside>

    <!-- MAIN -->
    <div class="ep-main">

        <!-- DESKTOP HEADER -->
        <div class="ep-header">
            <h4>Portal</h4>

            <div class="ep-user">
                <img t-att-src="image_data_uri(request.env.user.partner_id.avatar_1024)"/>
                <span t-out="request.env.user.partner_id.name"/>
                <a href="/web/session/logout" style="margin-left:15px;">Logout</a>
            </div>
        </div>

        <!-- MOBILE HEADER -->
        <div class="ep-mobile-header">
            <strong>Portal</strong>
            <span t-out="request.env.user.partner_id.name"/>
        </div>

        <!-- CONTENT -->
        <div class="ep-content">
            <t t-raw="0"/>
        </div>

    </div>

</div>

<!-- MOBILE BOTTOM NAV -->
<nav class="ep-bottom-nav">

    <a href="/my"
       t-att-class="'active' if request.httprequest.path == '/my' else ''">
        Dashboard
    </a>

    <a href="/my/employee/requests"
       t-att-class="'active' if request.httprequest.path.startswith('/my/employee/requests') else ''">
        Requests
    </a>

    <!-- Only show Approvals tab if user has ANY approval group -->
    <t t-if="
        request.env.user.has_group('employee_portal_suite.group_employee_portal_manager')
        or request.env.user.has_group('employee_portal_suite.group_employee_portal_hr')
        or request.env.user.has_group('employee_portal_suite.group_employee_portal_finance')
        or request.env.user.has_group('employee_portal_suite.group_employee_portal_ceo')
        or request.env.user.has_group('employee_portal_suite.group_mr_purchase_rep')
        or request.env.user.has_group('employee_portal_suite.group_mr_store_manager')
        or request.env.user.has_group('employee_portal_suite.group_mr_project_manager')
        or request.env.user.has_group('employee_portal_suite.group_mr_projects_director')
    ">
        <a href="/my/employee/approvals">
            Approvals
        </a>
    </t>

    <t t-if="request.env.user.has_group('petty_cash_management.group_portal_petty_cash_user')">
        <a href="/my/petty-cash"
           t-att-class="'active' if request.httprequest.path.startswith('/my/petty-cash') else ''">
            Petty Cash
        </a>
    </t>

</nav>


</template>

</odoo>
